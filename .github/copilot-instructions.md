# Copilot Instructions for `rust_minigrep`

## Project Overview
- **Purpose:** A learning-focused, minimal Rust CLI tool that mimics `grep`. It parses CLI args, reads files, and prints lines matching a query. Case sensitivity is toggled via the `IGNORE_CASE` environment variable.
- **Architecture:**
  - Entrypoint: `src/main.rs` (minimal logic)
  - Shared/search logic: `src/lib.rs`
  - Tests: Unit tests inline in `src/`, integration tests in `tests/` (if present)
  - Build artifacts: `target/` (ignored by git)

## Developer Workflows
- **Build:** `cargo build` (debug), `cargo build --release` (release)
- **Run:** `cargo run -- <query> <file>` (e.g., `cargo run -- to poem.txt`)
- **Test:** `cargo test` (all tests), `cargo test -- --nocapture` (show output)
- **Lint/Format:** `cargo fmt --all`, `cargo clippy --all-targets --all-features`
- **Install:** `cargo install --path .` (local binary)

## Coding Conventions
- **Edition:** Rust 2024, 4-space indentation
- **Naming:**
  - Functions/files: `snake_case`
  - Types/traits: `CamelCase`
  - Constants: `UPPER_SNAKE_CASE`
- **Error Handling:** Prefer `Result<T, E>` and `?` operator; avoid panics and unchecked `expect`.
- **Main Function:** Keep minimal; move logic to `lib.rs`.

## Testing Patterns
- **Unit tests:** Inline in `src/*.rs` behind `#[cfg(test)]`
- **Integration tests:** In `tests/` (if present), use public API
- **Test naming:** Describe behavior, e.g. `search_finds_substring()`

## Git & Documentation
- **Commits:** Short, imperative subject (â‰¤72 chars). If committing from Ubuntu, append `[codex-cli]`; from WSL, append `[g15][codex-cli]`.
- **CHANGELOG.md:** Reference code changes, especially in `src/main.rs` and `src/lib.rs`, with commit links.
- **README.md:** Hyperlink files/commits for navigation. Attribute to codex-cli if generated by AI.

## Security & CLI
- Validate CLI arg count before indexing; print usage/help on error.
- Avoid unchecked I/O operations; propagate errors.

## Example Patterns
- Case-insensitive search: set `IGNORE_CASE=1` in environment
- Show help: `cargo run -- --help`

## Key Files
- `src/main.rs`: CLI parsing, entrypoint
- `src/lib.rs`: Search logic, shared functions
- `README.md`, `CHANGELOG.md`, `AGENTS.md`: Project documentation and conventions

---
*This file is maintained for AI agent productivity. Update as project evolves.*
